{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Test X3D custom model",
            "type": "debugpy",
            "request": "launch",
            "program": "${workspaceFolder}/tools/run_net.py",
            "cwd": "${workspaceFolder}",
            "console": "integratedTerminal",
            "args": [
                "--cfg",
                "configs/Custom/X3D_M_custom.yaml",
                "--opts",
                "DATA.PATH_TO_DATA_DIR",
                "./mmaction2/110_video_frames_200_test2",
                "DATA.PATH_PREFIX",
                "./mmaction2/110_video_frames_200_test2",
                "TRAIN.ENABLE",
                "False",
                "TEST.ENABLE",
                "True",
                "TEST.CHECKPOINT_FILE_PATH",
                "output/custom_x3d_2/checkpoints/checkpoint_epoch_00150.pyth",
                "TEST.CHECKPOINT_TYPE",
                "pytorch",
                "TEST.NUM_SPATIAL_CROPS",
                "1",
                "TEST.SAVE_RESULTS_PATH",
                "test_results.pkl"
            ],
            "env": {
                "PYTHONUNBUFFERED": "1"
            }
        },
        {
            "name": "Report misclassifications (from test_results.pkl)",
            "type": "debugpy",
            "request": "launch",
            "program": "${workspaceFolder}/tools/report_misclassifications.py",
            "cwd": "${workspaceFolder}",
            "console": "integratedTerminal",
            "args": [
                "--results", "./output/custom_x3d_3/test_results.pkl",
                "--data_dir", "./mmaction2/110_video_frames_200_test2",
                "--path_prefix", "./mmaction2/110_video_frames_200_test2",
                "--topk", "2",
                "--out_csv", "./output/custom_x3d_3/misclassified.csv"
            ],
            "env": {
                "PYTHONUNBUFFERED": "1"
            }
        },
        {
            "name": "Export X3D to ONNX",
            "type": "debugpy",
            "request": "launch",
            "program": "${workspaceFolder}/export_onnx_final.py",
            "cwd": "${workspaceFolder}",
            "console": "integratedTerminal",
            "args": [
                "--cfg",
                "configs/Custom/X3D_M_custom.yaml",
                "--checkpoint",
                "output/custom_x3d_3/checkpoints/checkpoint_epoch_00150.pyth",
                "--output",
                "output/custom_x3d_3/model.onnx",
                // "--export_softmax",
                "--simplify",
                "--test_frames",
                "mmaction2/110_video_frames_200_test2/bird/Smart_Record_00049_20251113-032810_68600_1",
                "--class_names", "鸟,无人机"
            ],
            "env": {
                "PYTHONUNBUFFERED": "1"
            }
        },
        {
            "name": "ONNX Inference (X3D ONNX)",
            "type": "debugpy",
            "request": "launch",
            "program": "${workspaceFolder}/onnx_inference.py",
            "cwd": "${workspaceFolder}",
            "console": "integratedTerminal",
            "args": [
                "--onnx_model",
                "output/custom_x3d_3/model_simplified.onnx",
                "--input_folder",
                "mmaction2/110_video_frames_200_test2/uav/Smart_Record_00180_20251113-093516_68600_7",
                "--cfg",
                "configs/Custom/X3D_M_custom.yaml"
            ],
            "env": {
                "PYTHONUNBUFFERED": "1"
            }
        },
        {
            "name": "TensorRT Inference (X3D)",
            "type": "debugpy",
            "request": "launch",
            "program": "${workspaceFolder}/tensorrt_inference.py",
            "cwd": "${workspaceFolder}",
            "console": "integratedTerminal",
            "args": [
                "--engine",
                "output/custom_x3d_3/custom_x3d_3.engine",
                "--frames",
                "mmaction2/110_video_frames_200_test2/uav/Smart_Record_00180_20251113-093516_68600_7",
                "--num_frames",
                "32",
                "--sampling_rate",
                "5",
                "--crop_size",
                "64",
                "--print_input_samples",
                "--class_names",
                "鸟,无人机"
            ],
            "env": {
                "PYTHONUNBUFFERED": "1"
            }
        }
    ]
}